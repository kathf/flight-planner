//= require jquery
//= require jquery_ujs
//= require jquery-ui/autocomplete
//= require bootstrap
//= require turbolinks
//= require_tree .


detectUserLocation();

$(window).load(function () {
  console.log("window load");

  var map,
      mapAddOns,
      origin_attribute,
      destination_attribute,
      optionAirports,
      wayAirports,
      wayAirportMarkers = []
  ;

  map = initializeMap();
  mapAddOns = {
    infowindow: createInfoWindow(map),
    flightPath: createFlightPath(map),
  }

  getDataFromWaysController("/ways.json", optionAirports, wayAirports);

  formSetUp("#airport01-name");
  formSetUp("#airport02-name");
  autocomplete("airport01");
  autocomplete("airport02");
  wayPath = getWayPath();

  $("#btn-submit").click( function(event) {
    event.preventDefault();
    formSubmit();
    revertForm();
    deleteMarkers(optionAirports);
    deleteMarkers(wayAirports);
    var url = wayPath + ".json";
    getDataFromWaysController(url, optionAirports, wayAirports);
    window.location.href = "http://localhost:3000/" + wayPath;
  });
});
